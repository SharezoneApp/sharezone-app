# Copyright (c) 2022 Sharezone UG (haftungsbeschr√§nkt)
# Licensed under the EUPL-1.2-or-later.
#
# You may obtain a copy of the Licence at:
# https://joinup.ec.europa.eu/software/page/eupl
#
# SPDX-License-Identifier: EUPL-1.2

name: website-cd

concurrency:
  # Avoids running multiple deployments at the same time which would cause
  # conflicts.
  group: website-release

on:
  push:
    branches:
      - main

# Set permissions to none.
#
# Using the broad default permissions is considered a bad security practice
# and would cause alerts from our scanning tools.
permissions: {}

jobs:
  deploy:
    runs-on: ubuntu-22.04
    name: docs-deploy-prod
    permissions:
      checks: write # for FirebaseExtended/action-hosting-deploy
    steps:
      - uses: actions/checkout@b4ffde65f46336ab88eb53be808477a3936bae11

      - uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: "${{ secrets.GITHUB_TOKEN }}"
          firebaseServiceAccount: ${{ secrets.FIREBASE_HOSTING_PROD_KEY }}
          channelId: live
          entryPoint: "./docs"
          projectId: "sharezone-c2bd8"
        env:
          FIREBASE_CLI_EXPERIMENTS: webframeworks
